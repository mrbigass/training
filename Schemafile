# -*- mode: ruby -*-
# vi: set ft=ruby :

def create_table(table_name)
  opts = 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci'
  super table_name, options: opts
end

create_table :users do |t|
  t.references :office, index: true, null: false
  t.string :name, null: false, default: ''
  t.string :email, null: false, default: ''
  t.string :password_digest, null: false, default: ''

  t.timestamps null: false
end

create_table :machines do |t|
  t.string :name, null: false
  t.integer :office_id, null: false
end

create_table :offices do |t|
  t.string :name, null: false
end

create_table :customers do |t|
  t.string :name, null: false
end

create_table :lendings do |t|
  t.integer :machine_id, null: false
  t.integer :customer_id, null: false
  t.datetime :lend_at, null: false
  t.datetime :return_at, null: false
end

add_foreign_key :users, :offices, on_delete: :cascade
